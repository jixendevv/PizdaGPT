<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PizdaGPT</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #ffffff;
    --surface: #f5f5f5;
    --surface2: #ebebeb;
    --border: #d4d4d4;
    --border-dark: #a3a3a3;
    --text: #0a0a0a;
    --text-muted: #737373;
    --text-light: #a3a3a3;
  }

  body {
    font-family: 'Syne', sans-serif;
    background: var(--bg);
    color: var(--text);
    height: 100dvh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: radial-gradient(circle, #d4d4d4 1px, transparent 1px);
    background-size: 28px 28px;
    pointer-events: none;
    z-index: 0;
    opacity: 0.55;
  }

  /* HEADER */
  header {
    position: relative;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 14px 24px;
    border-bottom: 1.5px solid var(--border);
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(16px);
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.15rem;
    font-weight: 800;
    letter-spacing: -0.04em;
  }

  .logo-icon {
    width: 34px; height: 34px;
    border-radius: 9px;
    background: var(--text);
    display: flex; align-items: center; justify-content: center;
  }

  .header-right { display: flex; align-items: center; gap: 10px; }

  .model-selector {
    background: var(--surface);
    border: 1.5px solid var(--border);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 0.72rem;
    padding: 6px 10px;
    border-radius: 8px;
    outline: none;
    cursor: pointer;
  }
  .model-selector:focus { border-color: var(--text); }

  .status-badge {
    display: flex; align-items: center; gap: 6px;
    font-family: 'DM Mono', monospace;
    font-size: 0.72rem;
    color: var(--text-muted);
    background: var(--surface);
    border: 1.5px solid var(--border);
    padding: 6px 12px;
    border-radius: 20px;
  }

  .status-dot {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: #171717;
    animation: blink 2.5s infinite;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.2; }
  }

  .clear-btn {
    background: none;
    border: 1.5px solid var(--border);
    color: var(--text-muted);
    font-family: 'DM Mono', monospace;
    font-size: 0.7rem;
    padding: 6px 12px;
    border-radius: 8px;
    cursor: pointer;
    display: flex; align-items: center; gap: 5px;
    transition: all 0.2s;
  }
  .clear-btn:hover { border-color: var(--text); color: var(--text); background: var(--surface); }

  /* CHAT */
  .chat-area {
    flex: 1;
    overflow-y: auto;
    padding: 28px 20px;
    position: relative;
    z-index: 5;
    display: flex;
    flex-direction: column;
    gap: 18px;
    scroll-behavior: smooth;
  }
  .chat-area::-webkit-scrollbar { width: 4px; }
  .chat-area::-webkit-scrollbar-thumb { background: var(--border-dark); border-radius: 4px; }

  /* WELCOME */
  .welcome {
    margin: auto;
    text-align: center;
    padding: 50px 20px;
    max-width: 480px;
    animation: fadeUp 0.5s ease;
  }

  .welcome-logo {
    width: 64px; height: 64px;
    border-radius: 18px;
    background: var(--text);
    display: flex; align-items: center; justify-content: center;
    margin: 0 auto 20px;
  }

  .welcome h2 {
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: -0.05em;
    margin-bottom: 10px;
  }

  .welcome p {
    color: var(--text-muted);
    font-family: 'DM Mono', monospace;
    font-size: 0.82rem;
    line-height: 1.75;
    margin-bottom: 28px;
  }

  .suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
  }

  .suggestion-btn {
    background: var(--bg);
    border: 1.5px solid var(--border);
    color: var(--text-muted);
    font-family: 'DM Mono', monospace;
    font-size: 0.73rem;
    padding: 8px 14px;
    border-radius: 20px;
    cursor: pointer;
    display: flex; align-items: center; gap: 6px;
    transition: all 0.2s;
  }
  .suggestion-btn:hover { border-color: var(--text); color: var(--text); background: var(--surface); }

  /* MESSAGES */
  .message {
    display: flex;
    gap: 10px;
    max-width: 780px;
    width: 100%;
    animation: fadeUp 0.25s ease;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .message.user { flex-direction: row-reverse; margin-left: auto; }
  .message.assistant { margin-right: auto; }

  .avatar {
    width: 34px; height: 34px;
    border-radius: 9px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .message.user .avatar { background: var(--text); }
  .message.assistant .avatar { background: var(--surface); border: 1.5px solid var(--border); }

  .bubble {
    padding: 12px 16px;
    border-radius: 16px;
    font-size: 0.88rem;
    line-height: 1.7;
    max-width: calc(100% - 46px);
  }

  .message.user .bubble {
    background: var(--text);
    color: #fff;
    border-top-right-radius: 4px;
  }

  .message.assistant .bubble {
    background: var(--surface);
    color: var(--text);
    border: 1.5px solid var(--border);
    border-top-left-radius: 4px;
    font-family: 'DM Mono', monospace;
    font-size: 0.83rem;
  }

  .bubble p { margin-bottom: 8px; }
  .bubble p:last-child { margin-bottom: 0; }
  .bubble code {
    background: var(--surface2);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.85em;
    font-family: 'DM Mono', monospace;
    border: 1px solid var(--border);
  }
  .bubble pre {
    background: #0a0a0a;
    color: #e5e5e5;
    padding: 14px;
    border-radius: 10px;
    overflow-x: auto;
    margin: 8px 0;
    font-size: 0.82em;
    font-family: 'DM Mono', monospace;
  }
  .bubble pre code { background: none; border: none; color: inherit; padding: 0; }
  .bubble strong { font-weight: 700; }
  .bubble em { font-style: italic; }
  .bubble ul, .bubble ol { padding-left: 18px; margin: 6px 0; }
  .bubble li { margin-bottom: 4px; }

  /* TYPING */
  .typing-indicator { display: flex; align-items: center; gap: 4px; padding: 4px 0; }
  .typing-indicator span {
    width: 6px; height: 6px;
    border-radius: 50%;
    background: var(--text);
    animation: typeBounce 1.2s infinite;
  }
  .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
  .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

  @keyframes typeBounce {
    0%, 80%, 100% { transform: scale(0.5); opacity: 0.3; }
    40% { transform: scale(1.1); opacity: 1; }
  }

  /* INPUT */
  .input-area {
    position: relative;
    z-index: 10;
    padding: 14px 20px 20px;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(16px);
    border-top: 1.5px solid var(--border);
  }

  .input-wrap {
    display: flex;
    align-items: flex-end;
    gap: 10px;
    background: var(--bg);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    padding: 10px 10px 10px 16px;
    max-width: 780px;
    margin: 0 auto;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .input-wrap:focus-within {
    border-color: var(--text);
    box-shadow: 0 0 0 3px rgba(10,10,10,0.07);
  }

  textarea {
    flex: 1;
    border: none; outline: none; background: none;
    color: var(--text);
    font-family: 'Syne', sans-serif;
    font-size: 0.9rem;
    font-weight: 500;
    resize: none;
    min-height: 24px;
    max-height: 150px;
    line-height: 1.5;
    overflow-y: auto;
  }
  textarea::placeholder { color: var(--text-light); font-weight: 400; }

  .send-btn {
    width: 38px; height: 38px;
    border-radius: 10px;
    background: var(--text);
    border: none;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    transition: all 0.18s;
  }
  .send-btn:hover { background: #333; transform: scale(1.04); }
  .send-btn:active { transform: scale(0.95); }
  .send-btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none; }

  .hint {
    text-align: center;
    font-family: 'DM Mono', monospace;
    font-size: 0.68rem;
    color: var(--text-light);
    margin-top: 8px;
    max-width: 780px;
    margin-left: auto; margin-right: auto;
  }

  .error-msg {
    background: var(--surface);
    border: 1.5px solid var(--border);
    color: var(--text-muted);
    font-family: 'DM Mono', monospace;
    font-size: 0.78rem;
    padding: 10px 16px;
    border-radius: 10px;
    margin-top: 8px;
    max-width: 780px;
    margin-left: auto; margin-right: auto;
    display: flex; align-items: center; gap: 8px;
  }
</style>
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-icon">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
      </svg>
    </div>
    PizdaGPT
  </div>
  <div class="header-right">
    <select class="model-selector" id="modelSelect">
      <option value="llama-3.3-70b-versatile">Llama 3.3 70B</option>
      <option value="llama-3.1-8b-instant">Llama 3.1 8B ⚡</option>
      <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
      <option value="gemma2-9b-it">Gemma 2 9B</option>
      <option value="deepseek-r1-distill-llama-70b">DeepSeek R1 70B</option>
    </select>
    <button class="clear-btn" onclick="clearChat()">
      <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4h6v2"/>
      </svg>
      Limpiar
    </button>
    <div class="status-badge">
      <div class="status-dot"></div>
      EN LÍNEA
    </div>
  </div>
</header>

<div class="chat-area" id="chatArea">
  <div class="welcome" id="welcomeScreen">
    <div class="welcome-logo">
      <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
      </svg>
    </div>
    <h2>Hola, soy PizdaGPT</h2>
    <p>Impulsado por Groq — la inferencia más rápida del mundo.<br>Llama 3, Mixtral, DeepSeek y más. Todo gratis.</p>
    <div class="suggestions">
      <button class="suggestion-btn" onclick="sendSuggestion('¿Qué puedes hacer por mí?')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        ¿Qué puedes hacer?
      </button>
      <button class="suggestion-btn" onclick="sendSuggestion('Escribe un poema corto sobre la noche')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
        Escribe un poema
      </button>
      <button class="suggestion-btn" onclick="sendSuggestion('Explícame qué es la inteligencia artificial')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
        Explica la IA
      </button>
      <button class="suggestion-btn" onclick="sendSuggestion('Escribe código Python para ordenar una lista de números')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
        Código Python
      </button>
      <button class="suggestion-btn" onclick="sendSuggestion('Dame ideas de nombres para una startup de tecnología')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        Ideas startup
      </button>
      <button class="suggestion-btn" onclick="sendSuggestion('Traduce al inglés: El sol brilla con fuerza hoy')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/></svg>
        Traducir
      </button>
    </div>
  </div>
</div>

<div class="input-area">
  <div class="input-wrap">
    <textarea id="userInput" placeholder="Escribe tu mensaje..." rows="1"
      onkeydown="handleKeyDown(event)" oninput="autoResize(this)"></textarea>
    <button class="send-btn" id="sendBtn" onclick="sendMessage()" title="Enviar">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
      </svg>
    </button>
  </div>
  <div class="hint">Enter para enviar &nbsp;·&nbsp; Shift+Enter para nueva línea</div>
  <div id="errorContainer"></div>
</div>

<script>
  const GROQ_KEY = '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';
  let history = [];
  let busy = false;

  const USER_SVG = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>`;
  const BOT_SVG = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#0a0a0a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>`;
  const WARN_SVG = `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>`;

  function autoResize(el) {
    el.style.height = 'auto';
    el.style.height = Math.min(el.scrollHeight, 150) + 'px';
  }

  function handleKeyDown(e) {
    if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
  }

  function sendSuggestion(text) {
    document.getElementById('userInput').value = text;
    sendMessage();
  }

  function clearChat() {
    history = [];
    document.getElementById('chatArea').innerHTML = `
      <div class="welcome" id="welcomeScreen">
        <div class="welcome-logo">
          <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
          </svg>
        </div>
        <h2>Chat reiniciado</h2>
        <p>El historial fue borrado.<br>¡Comienza una nueva conversación!</p>
      </div>`;
    document.getElementById('errorContainer').innerHTML = '';
  }

  function esc(t) { return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

  function fmt(text) {
    let h = text
      .replace(/```(\w*)\n?([\s\S]*?)```/g, (_, l, c) => `<pre><code>${esc(c.trim())}</code></pre>`)
      .replace(/`([^`]+)`/g, '<code>$1</code>')
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/\*(.*?)\*/g, '<em>$1</em>');
    return h.split('\n\n').map(p => p.trim()).filter(Boolean)
      .map(p => p.startsWith('<pre>') ? p : `<p>${p.replace(/\n/g,'<br>')}</p>`).join('');
  }

  function addMsg(role, content) {
    const w = document.getElementById('welcomeScreen');
    if (w) w.remove();
    const area = document.getElementById('chatArea');
    const div = document.createElement('div');
    div.className = `message ${role}`;
    div.innerHTML = `
      <div class="avatar">${role === 'user' ? USER_SVG : BOT_SVG}</div>
      <div class="bubble">${role === 'user' ? `<p>${esc(content)}</p>` : fmt(content)}</div>`;
    area.appendChild(div);
    area.scrollTop = area.scrollHeight;
  }

  function showTyping() {
    const w = document.getElementById('welcomeScreen');
    if (w) w.remove();
    const area = document.getElementById('chatArea');
    const div = document.createElement('div');
    div.className = 'message assistant';
    div.id = 'typing';
    div.innerHTML = `<div class="avatar">${BOT_SVG}</div><div class="bubble"><div class="typing-indicator"><span></span><span></span><span></span></div></div>`;
    area.appendChild(div);
    area.scrollTop = area.scrollHeight;
  }

  function removeTyping() {
    const t = document.getElementById('typing');
    if (t) t.remove();
  }

  function showError(msg) {
    document.getElementById('errorContainer').innerHTML =
      `<div class="error-msg">${WARN_SVG} ${msg}</div>`;
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const model = document.getElementById('modelSelect').value;
    const msg = input.value.trim();
    if (!msg || busy) return;

    document.getElementById('errorContainer').innerHTML = '';
    busy = true;
    sendBtn.disabled = true;
    input.value = '';
    input.style.height = 'auto';

    addMsg('user', msg);
    history.push({ role: 'user', content: msg });
    showTyping();

    try {
      const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${GROQ_KEY}` },
        body: JSON.stringify({
          model,
          messages: [
            { role: 'system', content: 'Eres PizdaGPT, un asistente de inteligencia artificial rápido, inteligente y útil. Responde siempre en el idioma del usuario. Sé conciso pero completo.' },
            ...history
          ],
          max_tokens: 2048,
          temperature: 0.7
        })
      });

      const data = await res.json();
      removeTyping();

      if (!res.ok) { showError(data.error?.message || `Error ${res.status}`); history.pop(); return; }

      const reply = data.choices?.[0]?.message?.content || 'Sin respuesta.';
      history.push({ role: 'assistant', content: reply });
      addMsg('assistant', reply);

    } catch (err) {
      removeTyping();
      showError(`Error de conexión: ${err.message}`);
      history.pop();
    } finally {
      busy = false;
      sendBtn.disabled = false;
      input.focus();
    }
  }
</script>
</body>
</html>